{
  "version": "2.1",
  "suppliers": [    
    {
      "name": "POL",
      "Currency": "USD",
      "detection": { "fileNamePatterns": [ "pol*.xls*", "POL*.xls*" ] },
      "parserConfig": {
        "settings": {
          "stopOnFirstMatchPerColumn": false,
          "defaultCulture": "en-US",
          "preferFirstAssignment": true
        },
        "lookups": {
          "unitLookups": {
            "ml": "ML",
            "oz": "OZ",
            "l": "L",
            "cl": "CL",
            "floz": "FL OZ",
            "fl oz": "FL OZ"
          },
          "typeLookups": {
            "reg": "Regular",
            "mini": "Mini",
            "giftset": "Giftset",
            "set": "Set",
            "tube": "Tube",
            "tester": "Tester",
            "niche": "Niche",
            "rollerball": "Roller ball",
            "flash": "Flash"
          },
          "concentrationLookups": {
            "edt": "EDT",
            "edp": "EDP",
            "edc": "EDC",
            "parfum": "Parfum",
            "perfume": "Parfum",
            "cologne": "EDC",
            "eau de toilette": "EDT",
            "eau de parfum": "EDP"
          },

          "genderLookups": {
            "men": "M",
            "wom": "W",
            "homme": "M",
            "femme": "W",
            "her": "W",
            "p/homme": "M",
            "m": "M",
            "w": "W",
            "u": "U"
          }
        },
        "columns": [
          {
            "column": "A",
            "rule": {
              "actions": [
                {
                  "Op": "Split",
                  "Input": "Text",
                  "Output": "SplitText",
                  "Parameters": { "delimiter": ":" }
                },
                {
                  "Op": "Conditional",
                  "Input": "SplitText[0]",
                  "Output": "Product.Brand",
                  "Parameters": {
                    "condition": "SplitText.Length == 3",
                    "assign": "true"
                  }
                },
                {
                  "Op": "Conditional",
                  "Input": "SplitText[1]",
                  "Output": "GenderOrType",
                  "Parameters": { "condition": "SplitText.Length == 3" }
                },
                {
                  "Op": "Conditional",
                  "Input": "SplitText[2]",
                  "Output": "Offer.Ref",
                  "Parameters": {
                    "condition": "SplitText.Length == 3",
                    "assign": "true"
                  }
                },
                {
                  "Op": "Map",
                  "Input": "GenderOrType",
                  "Output": "Product.Gender",
                  "Parameters": {
                    "table": "genderLookups",
                    "assign": "true"
                  }
                },
                {
                  "Op": "Map",
                  "Input": "GenderOrType",
                  "Output": "Product.Type",
                  "Parameters": {
                    "table": "typeLookups",
                    "assign": "true"
                  }
                }
              ]
            }
          },
          {
            "column": "B",
            "rule": {
              "actions": [
                {
                  "Op": "Assign",
                  "Input": "Text",
                  "Output": "Offer.Description"
                },

                {
                  "Op": "Find",
                  "Input": "Text",
                  "Output": "Sizes",
                  "Parameters": {
                    "pattern": "(?i)(?<size>\\d+(?:\\.\\d+)?\\s*(?:ml|oz|fl\\s*oz))",
                    "options": "all,ignorecase,remove"
                  }
                },

                {
                  "Op": "Find",
                  "Input": "Sizes[0]",
                  "Output": "Product.Size",
                  "Parameters": {
                    "pattern": "(?<num>\\d+(?:\\.\\d+)?)",
                    "options": "first,assign"
                  }
                },

                {
                  "Op": "Find",
                  "Input": "Sizes[0]",
                  "Output": "UnitRaw",
                  "Parameters": {
                    "pattern": "(?i)(?<unit>ml|oz|fl\\s*oz)",
                    "options": "first,ignorecase"
                  }
                },

                {
                  "Op": "Map",
                  "Input": "UnitRaw",
                  "Output": "Product.Units",
                  "Parameters": {
                    "table": "unitLookups",
                    "assign": "true"
                  }
                },
                {
                  "Op": "Find",
                  "Input": "Sizes.Clean",
                  "Output": "Concentrations",
                  "Parameters": {
                    "pattern": "lookup:concentrationLookups",
                    "options": "all,ignorecase,remove"
                  }
                },
                {
                  "Op": "Map",
                  "Input": "Concentrations[0]",
                  "Output": "Product.Concentration",
                  "Parameters": {
                    "table": "concentrationLookups",
                    "assign": "true"
                  }
                },
                {
                  "Op": "Find",
                  "Input": "Concentrations.Clean",
                  "Output": "Genders",
                  "Parameters": {
                    "pattern": "lookup:genderLookups",
                    "options": "all,ignorecase,remove"
                  }
                },
                {
                  "Op": "Map",
                  "Input": "Genders[0]",
                  "Output": "Product.Gender",
                  "Parameters": {
                    "table": "genderLookups",
                    "assign": "true"
                  }
                },
                {
                  "Op": "Find",
                  "Input": "Genders.Clean",
                  "Output": "Types",
                  "Parameters": {
                    "pattern": "lookup:typeLookups",
                    "options": "all,ignorecase,remove"
                  }
                },
                {
                  "Op": "Map",
                  "Input": "Types[0]",
                  "Output": "Product.Type",
                  "Parameters": {
                    "table": "typeLookups",
                    "assign": "true"
                  }
                },
                {
                  "Op": "Find",
                  "Input": "Types.Clean",
                  "Output": "FinalText",
                  "Parameters": {
                    "pattern": "[/-]*",
                    "options": "all,ignorecase,remove"
                  }
                },
                {
                  "Op": "Assign",
                  "Input": "FinalText.Clean",
                  "Output": "Product.Line"
                }
              ]
            }
          },
          {
            "column": "C",
            "rule": {
              "actions": [
                {
                  "Op": "Assign",
                  "Input": "Text",
                  "Output": "Product.EAN"
                }
              ]
            }
          },
          {
            "column": "D",
            "rule": {
              "actions": [
                {
                  "Op": "Assign",
                  "Input": "Text",
                  "Output": "Offer.Quantity"
                }
              ]
            }
          },
          {
            "column": "E",
            "rule": {
              "actions": [
                {
                  "Op": "Assign",
                  "Input": "Text",
                  "Output": "Offer.Price"
                }
              ]
            }
          }
        ]
      },
      "fileStructure": {
        "dataStartRowIndex": 8,
        "expectedColumnCount": 5,
        "headerRowIndex": 1
      }
    }   
  ],
  "columnTemplates": {
    "version": "1.0",
    "productType": "perfume",
    "templates": {
      "EAN": {
        "rule": {
          "actions": [
            {"Op": "Assign", "Input": "Text", "Output": "Product.EAN"}
          ]
        },
        "metadata": {
          "displayName": "EAN Code",
          "description": "European Article Number (barcode)",
          "classification": "ProductEAN",
          "validation": {
            "patterns": ["^\\d+$"],
            "maxLength": 20,
            "isRequired": true,
            "skipEntireRow": true
          }
        }
      },
      "Name": {
        "rule": {
          "actions": [
            {"Op": "Assign", "Input": "Text", "Output": "Product.Name"}
          ]
        },
        "metadata": {
          "displayName": "Name",
          "description": "Product name",
          "classification": "ProductName"
        }
      },
      "Price": {
        "rule": {
          "actions": [
            {"Op": "Assign", "Input": "Text", "Output": "Offer.Price"}
          ]
        },
        "metadata": {
          "displayName": "Price",
          "description": "Product price from offers",
          "classification": "OfferPrice",
          "validation": {
            "dataType": "decimal",
            "isRequired": true,
            "skipEntireRow": true
          }
        }
      },
      "Currency": {
        "rule": {
          "actions": [
            {"Op": "Assign", "Input": "Text", "Output": "Offer.Currency"}
          ]
        },
        "metadata": {
          "displayName": "Currency",
          "description": "Currency of the price",
          "classification": "OfferCurrency",
          "validation": {
            "isRequired": true
          }
        }
      },
      "Quantity": {
        "rule": {
          "actions": [
            {"Op": "RemoveSymbols", "Input": "Text", "Output": "Quantity.Clean"},
            {"Op": "Assign", "Input": "Quantity.Clean", "Output": "Offer.Quantity"}
          ]
        },
        "metadata": {
          "displayName": "Quantity",
          "description": "Available stock quantity",
          "classification": "OfferQuantity",
          "validation": {
            "dataType": "integer",
            "isRequired": true,
            "skipEntireRow": true
          }
        }
      },
      "Description": {
        "rule": {
          "actions": [
            {"Op": "Assign", "Input": "Text", "Output": "Offer.Description"}
          ]
        },
        "metadata": {
          "displayName": "Description",
          "description": "Product description",
          "classification": "OfferDescription",
          "validation": {
            "maxLength": 500
          }
        }
      }
    }
  }
}