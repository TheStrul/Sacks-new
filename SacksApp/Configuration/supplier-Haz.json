{
  "Name": "Haz",
  "Currency": "USD",
  "ParserConfig": {
    "Settings": {
      "StopOnFirstMatchPerColumn": false,
      "DefaultCulture": "en-US"
    },
    "ColumnRules": [
      {
        "Column": "A",
        "Actions": [
          {
            "Op": "Assign",
            "Input": "Text",
            "Output": "Product.EAN",
            "Assign": true,
            "Condition": null,
            "Parameters": null
          }
        ]
      },
      {
        "Column": "B",
        "Actions": [
          {
            "Op": "Assign",
            "Input": "Text",
            "Output": "Offer.Description",
            "Assign": true,
            "Condition": null,
            "Parameters": null
          },
          {
            "Op": "Find",
            "Input": "Text",
            "Output": "TextNoBrand",
            "Assign": false,
            "Condition": null,
            "Parameters": {
              "PatternKey": "Product.Brand",
              "Options": "first,ignorecase,remove"
            }
          },
          {
            "Op": "Find",
            "Input": "TextNoBrand.Clean",
            "Output": "SizeAndUnit",
            "Assign": false,
            "Condition": null,
            "Parameters": {
              "Pattern": "(?i)(?<size>\\d+(?:\\.\\d+)?\\s*(?:ML|OZ))\\b",
              "Options": "first,ignorecase,remove"
            }
          },
          {
            "Op": "Find",
            "Input": "SizeAndUnit",
            "Output": "Product.Size",
            "Assign": true,
            "Condition": "SizeAndUnit.Valid==true",
            "Parameters": {
              "Pattern": "(?<num>\\d+(?:\\.\\d+)?)",
              "Options": "first"
            }
          },
          {
            "Op": "Find",
            "Input": "SizeAndUnit",
            "Output": "Product.Units",
            "Assign": true,
            "Condition": "SizeAndUnit.Valid==true",
            "Parameters": {
              "Pattern": "(?i)(?<unit>ML|OZ)",
              "Options": "first"
            }
          },
          {
            "Op": "Find",
            "Input": "SizeAndUnit.Clean",
            "Output": "Concentrations",
            "Assign": false,
            "Condition": null,
            "Parameters": {
              "Pattern": "lookup:Concentration",
              "Options": "first,ignorecase,remove"
            }
          },
          {
            "Op": "Map",
            "Input": "Concentrations",
            "Output": "Product.Concentration",
            "Assign": true,
            "Condition": "Concentrations.Valid==true",
            "Parameters": {
              "Table": "Concentration"
            }
          },
          {
            "Op": "Find",
            "Input": "Concentrations.Clean",
            "Output": "Genders",
            "Assign": false,
            "Condition": null,
            "Parameters": {
              "Pattern": "(?i)\\b(WOMEN|MEN|MALE|FEMALE)\\b",
              "Options": "first,ignorecase,remove"
            }
          },
          {
            "Op": "Map",
            "Input": "Genders",
            "Output": "Product.Gender",
            "Assign": true,
            "Condition": "Genders.Valid==true",
            "Parameters": {
              "Table": "Gender"
            }
          },
          {
            "Op": "Assign",
            "Input": "Genders.Clean",
            "Output": "Product.Name",
            "Assign": true,
            "Condition": null,
            "Parameters": null
          }
        ]
      },
      {
        "Column": "C",
        "Actions": [
          {
            "Op": "Map",
            "Input": "Text",
            "Output": "Product.Gender",
            "Assign": true,
            "Condition": null,
            "Parameters": {
              "Table": "Gender"
            }
          }
        ]
      },
      {
        "Column": "D",
        "Actions": [
          {
            "Op": "Assign",
            "Input": "Text",
            "Output": "Offer.Price",
            "Assign": true,
            "Condition": null,
            "Parameters": null
          }
        ]
      },
      {
        "Column": "E",
        "Actions": [
          {
            "Op": "Assign",
            "Input": "Text",
            "Output": "Offer.Quantity",
            "Assign": true,
            "Condition": null,
            "Parameters": null
          }
        ]
      }
    ]
  },
  "FileStructure": {
    "DataStartRowIndex": 7,
    "ExpectedColumnCount": 6,
    "HeaderRowIndex": 4,
    "Detection": {
      "FileNamePatterns": [
        "haz*.xls*"
      ]
    }
  },
  "SubtitleHandling": {
    "DetectionRules": [
      {
        "Key": "Section",
        "DetectionMethod": "pattern",
        "Pattern": "^(WOMEN|MEN)\\s+REFERENCES$",
        "ApplyToSubsequentRows": false,
        "ValidationPatterns": []
      }
    ],
    "FallbackAction": "skip",
    "Transforms": [],
    "Assignments": []
  }
}
