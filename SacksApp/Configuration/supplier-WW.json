{
  "Name": "WW",
  "Currency": "GBP",
  "ParserConfig": {
    "Settings": {
      "StopOnFirstMatchPerColumn": false,
      "DefaultCulture": "en-GB",
      "PreferFirstAssignment": true
    },
    "ColumnRules": [
      {
        "Column": "I",
        "Actions": [
          {
            "Op": "Map",
            "Input": "Text",
            "Output": "Product.Brand",
            "Assign": true,
            "Condition": null,
            "Parameters": {
              "Table": "Brand",
              "AddIfNotFound": "true"
            }
          }
        ]
      },
      {
        "Column": "H",
        "Actions": [
          {
            "Op": "Find",
            "Input": "Text",
            "Output": "TypeInfo",
            "Assign": false,
            "Condition": null,
            "Parameters": {
              "Pattern": "^\\d+\\.\\s*(?<type>.*)$",
              "Options": "first"
            }
          },
          {
            "Op": "Assign",
            "Input": "TypeInfo",
            "Output": "Product.Type 2",
            "Assign": true,
            "Condition": "TypeInfo.Valid == true",
            "Parameters": null
          }
        ]
      },
      {
        "Column": "B",
        "Actions": [
          {
            "Op": "Assign",
            "Input": "Text",
            "Output": "Offer.Description",
            "Assign": true,
            "Condition": null,
            "Parameters": null
          },
          {
            "Op": "Find",
            "Input": "Text",
            "Output": "BrandRemoval",
            "Assign": false,
            "Condition": "Product.Brand != null",
            "Parameters": {
              "Pattern": "^\\s*{Product.Brand}\\s*",
              "Options": "first,ignorecase,remove"
            }
          },
          {
            "Op": "Find",
            "Input": "BrandRemoval.Clean",
            "Output": "OriginMatch",
            "Assign": false,
            "Condition": null,
            "Parameters": {
              "Pattern": "(?i)-\\s*(?<origin>[A-Za-z]+)\\s*$",
              "Options": "first,ignorecase,remove"
            }
          },
          {
            "Op": "Map",
            "Input": "OriginMatch",
            "Output": "Product.COO",
            "Assign": true,
            "Condition": "OriginMatch.Valid == true",
            "Parameters": {
              "Table": "COO",
              "AddIfNotFound": "false"
            }
          },
          {
            "Op": "Find",
            "Input": "OriginMatch.Clean",
            "Output": "ProductCodeMatch",
            "Assign": false,
            "Condition": null,
            "Parameters": {
              "Pattern": "\\((?<code>\\d+)\\)",
              "Options": "first,remove"
            }
          },
          {
            "Op": "Assign",
            "Input": "ProductCodeMatch",
            "Output": "Offer.Ref",
            "Assign": true,
            "Condition": "ProductCodeMatch.Valid == true",
            "Parameters": null
          },
          {
            "Op": "Find",
            "Input": "ProductCodeMatch.Clean",
            "Output": "GenderMatch",
            "Assign": false,
            "Condition": null,
            "Parameters": {
              "Pattern": "\\b(?<gender>[UML])\\b",
              "Options": "first,remove"
            }
          },
          {
            "Op": "Map",
            "Input": "GenderMatch",
            "Output": "Product.Gender",
            "Assign": true,
            "Condition": "GenderMatch.Valid == true",
            "Parameters": {
              "Table": "Gender",
              "AddIfNotFound": "false"
            }
          },
          {
            "Op": "Find",
            "Input": "GenderMatch.Clean",
            "Output": "ConcentrationMatch",
            "Assign": false,
            "Condition": "Product.Type 2 != 'Set' && Product.Type 2 != 'Mini Set'",
            "Parameters": {
              "Pattern": "lookup:Concentration",
              "Options": "first,ignorecase,remove"
            }
          },
          {
            "Op": "Map",
            "Input": "ConcentrationMatch",
            "Output": "Product.Concentration",
            "Assign": true,
            "Condition": "ConcentrationMatch.Valid == true",
            "Parameters": {
              "Table": "Concentration"
            }
          },
          {
            "Op": "Find",
            "Input": "ConcentrationMatch.Clean",
            "Output": "SizeMatch",
            "Assign": false,
            "Condition": "Product.Type 2 != 'Set' && Product.Type 2 != 'Mini Set'",
            "Parameters": {
              "Pattern": "(?<size>\\d+[.,]\\d+)",
              "Options": "first,remove"
            }
          },
          {
            "Op": "Convert",
            "Input": "SizeMatch",
            "Output": "SizeInMl",
            "Assign": false,
            "Condition": "SizeMatch.Valid == true",
            "Parameters": {
              "Preset": "OzToMl"
            }
          },
          {
            "Op": "Assign",
            "Input": "SizeInMl",
            "Output": "Product.Size",
            "Assign": true,
            "Condition": "SizeMatch.Valid == true",
            "Parameters": null
          },
          {
            "Op": "Convert",
            "Input": "SizeMatch.Clean",
            "Output": "NameCleaned",
            "Assign": false,
            "Condition": null,
            "Parameters": {
              "Preset": "TrimWhitespace"
            }
          },
          {
            "Op": "Assign",
            "Input": "NameCleaned",
            "Output": "Product.Name",
            "Assign": true,
            "Condition": null,
            "Parameters": null
          }
        ]
      },
      {
        "Column": "C",
        "Actions": [
          {
            "Op": "Assign",
            "Input": "Text",
            "Output": "Product.EAN",
            "Assign": true,
            "Condition": null,
            "Parameters": null
          }
        ]
      },
      {
        "Column": "D",
        "Actions": [
          {
            "Op": "Assign",
            "Input": "Text",
            "Output": "Offer.Price",
            "Assign": true,
            "Condition": null,
            "Parameters": null
          }
        ]
      },
      {
        "Column": "E",
        "Actions": [
          {
            "Op": "Assign",
            "Input": "Text",
            "Output": "Offer.Quantity",
            "Assign": true,
            "Condition": null,
            "Parameters": null
          }
        ]
      }
    ]
  },
  "FileStructure": {
    "DataStartRowIndex": 2,
    "ExpectedColumnCount": 10,
    "HeaderRowIndex": 1,
    "Detection": {
      "FileNamePatterns": [
        "WW*.xls*"
      ]
    }
  },
  "SubtitleHandling": null
}
